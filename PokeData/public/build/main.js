function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a,c=!1;function l(e,t,n,r){for(;e<t;){const o=e+(t-e>>1);n(o)<=r?e=o+1:t=o}return e}function i(e,t){c?(!function(e){if(e.hydrate_init)return;e.hydrate_init=!0;const t=e.childNodes,n=new Int32Array(t.length+1),r=new Int32Array(t.length);n[0]=-1;let o=0;for(let e=0;e<t.length;e++){const s=l(1,o+1,(e=>t[n[e]].claim_order),t[e].claim_order)-1;r[e]=n[s]+1;const a=s+1;n[a]=e,o=Math.max(a,o)}const s=[],a=[];let c=t.length-1;for(let e=n[o]+1;0!=e;e=r[e-1]){for(s.push(t[e-1]);c>=e;c--)a.push(t[c]);c--}for(;c>=0;c--)a.push(t[c]);s.reverse(),a.sort(((e,t)=>e.claim_order-t.claim_order));for(let t=0,n=0;t<a.length;t++){for(;n<s.length&&a[t].claim_order>=s[n].claim_order;)n++;const r=n<s.length?s[n]:null;e.insertBefore(a[t],r)}}(e),(void 0===e.actual_end_child||null!==e.actual_end_child&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild),t!==e.actual_end_child?e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling):t.parentNode!==e&&e.appendChild(t)}function d(e,t,n){c&&!n?i(e,t):(t.parentNode!==e||n&&t.nextSibling!==n)&&e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function f(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function m(){return h(" ")}function p(){return h("")}function v(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function $(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function w(e,t){e.value=null==t?"":t}function b(e){a=e}function x(){if(!a)throw new Error("Function called outside component initialization");return a}function k(e){x().$$.on_mount.push(e)}function S(){const e=x();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach((t=>{t.call(e,o)}))}}}function C(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const P=[],A=[],I=[],j=[],E=Promise.resolve();let _=!1;function F(e){I.push(e)}function U(e){j.push(e)}let D=!1;const L=new Set;function N(){if(!D){D=!0;do{for(let e=0;e<P.length;e+=1){const t=P[e];b(t),T(t.$$)}for(b(null),P.length=0;A.length;)A.pop()();for(let e=0;e<I.length;e+=1){const t=I[e];L.has(t)||(L.add(t),t())}I.length=0}while(P.length);for(;j.length;)j.pop()();_=!1,D=!1,L.clear()}}function T(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(F)}}const M=new Set;let R;function z(e,t){e&&e.i&&(M.delete(e),e.i(t))}function O(e,t,n,r){if(e&&e.o){if(M.has(e))return;M.add(e),R.c.push((()=>{M.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function H(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function V(e){e&&e.c()}function J(e,n,s,a){const{fragment:c,on_mount:l,on_destroy:i,after_update:d}=e.$$;c&&c.m(n,s),a||F((()=>{const n=l.map(t).filter(o);i?i.push(...n):r(n),e.$$.on_mount=[]})),d.forEach(F)}function Z(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function B(e,t){-1===e.$$.dirty[0]&&(P.push(e),_||(_=!0,E.then(N)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function G(t,o,s,l,i,d,f=[-1]){const g=a;b(t);const h=t.$$={fragment:null,ctx:null,props:d,update:e,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(g?g.$$.context:o.context||[]),callbacks:n(),dirty:f,skip_bound:!1};let m=!1;if(h.ctx=s?s(t,o.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return h.ctx&&i(h.ctx[e],h.ctx[e]=o)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](o),m&&B(t,e)),n})):[],h.update(),m=!0,r(h.before_update),h.fragment=!!l&&l(h.ctx),o.target){if(o.hydrate){c=!0;const e=function(e){return Array.from(e.childNodes)}(o.target);h.fragment&&h.fragment.l(e),e.forEach(u)}else h.fragment&&h.fragment.c();o.intro&&z(t.$$.fragment),J(t,o.target,o.anchor,o.customElement),c=!1,N()}b(g)}class Y{$destroy(){Z(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const q={baseUrl:"https://maber-apim-test.azure-api.net/pokedata-api/v0",apiKey:"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTczNzMxNzE0MiwianRpIjoiNjJkNWU1ZjktNTI5ZC00NGIyLTlkMTgtOTY3NWQ3ZTU3NWMwIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6IjJlZGY1N2Y2LWU5OTYtNGNhMy1iZDk5LTFlZDY3MDRkMzJhOSIsIm5iZiI6MTczNzMxNzE0MiwidG9rZW5fdHlwZSI6ImFwaSJ9.y4JduoyU_gG1aiBy4w6frD3h3m-AEoxw_7f6vExYay4",subscriptionKey:"1c3e73f4352b415c98eb89f91541c4e4",endpoints:{pricing:"/pricing",sets:"/sets",set:"/set"},getHeaders:()=>({"Content-Type":"application/json"}),buildPricingUrl(e){return`${this.baseUrl}${this.endpoints.pricing}?id=${encodeURIComponent(e)}&asset_type=CARD`},buildSetsUrl(){return`${this.baseUrl}${this.endpoints.sets}`},buildCardsForSetUrl(e){return`${this.baseUrl}${this.endpoints.set}?set_id=${encodeURIComponent(e)}`}};async function W(e,t={}){try{console.log(`Fetching from: ${e}`),console.log("Using headers:",t.headers);const n=await fetch(e,{...t,mode:"cors"});if(!n.ok){const t=await n.text().catch((()=>"Unable to get error details"));throw console.error(`HTTP Error: ${n.status} - ${n.statusText}\nURL: ${e}\nDetails: ${t}`),new Error(`HTTP error! Status: ${n.status} - ${n.statusText}`)}return n}catch(t){throw console.error(`Fetch error for URL [${e}]:`,t),t}}const K="poke-data-db",Q="setList",X="cardsBySet",ee="cardPricing",te=()=>new Promise(((e,t)=>{const n=indexedDB.open(K,1);n.onerror=e=>{console.error("Error opening database:",e.target.error),t(e.target.error)},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(Q)||t.createObjectStore(Q,{keyPath:"id"}),t.objectStoreNames.contains(X)||t.createObjectStore(X,{keyPath:"setCode"}),t.objectStoreNames.contains(ee)||t.createObjectStore(ee,{keyPath:"id"})}})),ne={async saveSetList(e){try{const t=(await te()).transaction(Q,"readwrite"),n=t.objectStore(Q);return await n.put({id:"pokemonSets",data:e,timestamp:Date.now()}),new Promise(((e,n)=>{t.oncomplete=()=>e(),t.onerror=e=>n(e.target.error)}))}catch(e){throw console.error("Error saving set list:",e),e}},async getSetList(){try{const e=(await te()).transaction(Q,"readonly"),t=e.objectStore(Q).get("pokemonSets");return new Promise(((e,n)=>{t.onsuccess=()=>{t.result&&t.result.data?e(t.result.data):e(null)},t.onerror=e=>n(e.target.error)}))}catch(e){throw console.error("Error getting set list:",e),e}},async saveCardsForSet(e,t){try{const n=e||"unknown-set",r=(await te()).transaction(X,"readwrite"),o=r.objectStore(X);return await o.put({setCode:n,cards:t,timestamp:Date.now()}),new Promise(((e,t)=>{r.oncomplete=()=>e(),r.onerror=e=>t(e.target.error)}))}catch(t){throw console.error(`Error saving cards for set ${e}:`,t),t}},async getCardsForSet(e){try{const t=e||"unknown-set",n=(await te()).transaction(X,"readonly"),r=n.objectStore(X).get(t);return new Promise(((e,t)=>{r.onsuccess=()=>{r.result&&r.result.cards?e(r.result.cards):e(null)},r.onerror=e=>t(e.target.error)}))}catch(t){throw console.error(`Error getting cards for set ${e}:`,t),t}},async saveCardPricing(e,t){try{const n=(await te()).transaction(ee,"readwrite"),r=n.objectStore(ee);return await r.put({id:e,data:t,timestamp:Date.now()}),new Promise(((e,t)=>{n.oncomplete=()=>e(),n.onerror=e=>t(e.target.error)}))}catch(t){throw console.error(`Error saving pricing data for card ${e}:`,t),t}},async getCardPricing(e){try{const t=(await te()).transaction(ee,"readonly"),n=t.objectStore(ee).get(e);return new Promise(((e,t)=>{n.onsuccess=()=>{n.result&&n.result.data?e(n.result.data):e(null)},n.onerror=e=>t(e.target.error)}))}catch(t){throw console.error(`Error getting pricing data for card ${e}:`,t),t}},async hasCardsForSet(e){try{const t=e||"unknown-set";return null!==await this.getCardsForSet(t)}catch(t){return console.error(`Error checking if we have cards for set ${e}:`,t),!1}},async clearSetData(e){try{const t=e||"unknown-set",n=(await te()).transaction(X,"readwrite"),r=n.objectStore(X).delete(t);return new Promise(((t,n)=>{r.onsuccess=()=>{console.log(`Cleared cache for set ${e}`),t()},r.onerror=e=>n(e.target.error)}))}catch(t){throw console.error(`Error clearing data for set ${e}:`,t),t}},async clearCardPricing(e){try{const t=(await te()).transaction(ee,"readwrite"),n=t.objectStore(ee).delete(e);return new Promise(((t,r)=>{n.onsuccess=()=>{console.log(`Cleared pricing cache for card ${e}`),t()},n.onerror=e=>r(e.target.error)}))}catch(t){throw console.error(`Error clearing pricing data for card ${e}:`,t),t}},async storeCardPricing(e,t){try{const n=(await te()).transaction(ee,"readwrite"),r=n.objectStore(ee);return await r.put({id:e,data:t,timestamp:Date.now()}),new Promise(((e,t)=>{n.oncomplete=()=>e(),n.onerror=e=>t(e.target.error)}))}catch(t){throw console.error(`Error storing pricing for card ${e}:`,t),t}},async getCardPricing(e){try{const t=(await te()).transaction(ee,"readonly"),n=t.objectStore(ee).get(e);return new Promise(((e,t)=>{n.onsuccess=()=>{n.result&&n.result.data?e(n.result.data):e(null)},n.onerror=e=>t(e.target.error)}))}catch(t){throw console.error(`Error getting pricing for card ${e}:`,t),t}},async clearAllData(){try{const e=(await te()).transaction([Q,X,ee],"readwrite");return e.objectStore(Q).clear(),e.objectStore(X).clear(),e.objectStore(ee).clear(),new Promise(((t,n)=>{e.oncomplete=()=>{console.log("All cache data cleared successfully"),t()},e.onerror=e=>n(e.target.error)}))}catch(e){throw console.error("Error clearing all data:",e),e}},resetDatabase:async()=>new Promise(((e,t)=>{const n=indexedDB.deleteDatabase(K);n.onsuccess=()=>{console.log(`Database ${K} deleted successfully`),e()},n.onerror=e=>{console.error("Error deleting database:",e.target.error),t(e.target.error)},n.onblocked=()=>{console.warn("Database deletion blocked - may have open connections"),e()}}))};function re(e){return e.sort(((e,t)=>{const n=new Date(e.release_date||0);return new Date(t.release_date||0)-n}))}function oe(e){if(!e||!Array.isArray(e))return[];let t=0;return e.forEach((e=>{e.id&&"number"==typeof e.id&&e.id>t&&(t=e.id)})),e.map((e=>e.id?e:(t+=1,{...e,id:t})))}const se={async getSetList(){try{console.log("Fetching set list...");const e=await ne.getSetList();if(e&&e.length>0)return console.log(`Using cached sets data - ${e.length} sets`),re(oe(e));const t=q.buildSetsUrl();console.log(`Fetching sets from API: ${t}`);const n=await W(t,{headers:q.getHeaders()});if(!n.ok){const e=await n.text().catch((()=>"Unable to get error details"));throw console.error(`API error: ${n.status} - ${e}`),new Error(`API error: ${n.status}. Details: ${e}`)}const r=await n.json();console.log("API response for sets:",r);let o=r;!Array.isArray(r)&&r.data&&Array.isArray(r.data)&&(console.log("Found data wrapper in sets response"),o=r.data),!Array.isArray(r)&&r.sets&&Array.isArray(r.sets)&&(console.log("Found sets wrapper in response"),o=r.sets);const s=oe(o);return console.log(`Processed ${s.length} sets with IDs`),s&&Array.isArray(s)&&await ne.saveSetList(s),re(s)}catch(e){console.error("Error fetching sets:",e),console.log("Using hard-coded fallback set list due to API error");const{setList:t}=await import("./setList-d592518d.js");return re(t)}},async getCardsForSet(e,t){try{if(!t)return console.error("Set ID is required to fetch cards"),[];e||(console.warn("Set code is null or undefined, using fallback key for cache"),e=`id_${t}`);const n=await ne.getCardsForSet(e);if(n&&n.length>0)return console.log(`Using cached cards for set ${e}: ${n.length} cards`),n;console.log(`Fetching cards for set ${e} (ID: ${t}) from API...`);const r=q.buildCardsForSetUrl(t);console.log(`API URL for cards: ${r}`);const o=await W(r,{headers:q.getHeaders()});if(!o.ok){const t=await o.text().catch((()=>"Unable to get error details"));throw console.error(`API error for set ${e}: ${o.status} - ${t}`),new Error(`API error: ${o.status}. Details: ${t}`)}const s=await o.json();console.log(`API response for set ${e}:`,s);let a=[];if(s&&s.cards&&Array.isArray(s.cards))console.log(`Found cards array with ${s.cards.length} items`),a=s.cards;else if(s&&Array.isArray(s))console.log(`Response is a direct array with ${s.length} items`),a=s;else if(s&&s.data&&Array.isArray(s.data))console.log(`Response has a data array with ${s.data.length} items`),a=s.data;else if(s&&s.results&&Array.isArray(s.results))console.log(`Response has a results array with ${s.results.length} items`),a=s.results;else{console.warn("Unexpected data format:",s);for(const e in s)if(Array.isArray(s[e])&&s[e].length>0){console.log(`Found potential cards array in property '${e}' with ${s[e].length} items`),a=s[e];break}}return a.length>0&&console.log("First card sample:",a[0]),console.log(`Found ${a.length} cards for set ${e}`),a.length>0&&await ne.saveCardsForSet(e,a),a}catch(t){return console.error(`Error fetching cards for set ${e}:`,t),[]}},async getCardPricing(e){try{if(!e)throw new Error("Card ID is required to fetch pricing data");console.log(`Getting pricing data for card ID: ${e}`);const t=await ne.getCardPricing(e);if(t)return console.log(`Using cached pricing for card ${e}`),t;const n=q.buildPricingUrl(e);console.log(`API URL for pricing: ${n}`);const r=await W(n,{headers:q.getHeaders()});if(!r.ok){const t=await r.text().catch((()=>"Unable to get error details"));throw console.error(`API error for pricing ${e}: ${r.status} - ${t}`),new Error(`API error: ${r.status}. Details: ${t}`)}const o=await r.json();console.log(`Pricing API response for card ${e}:`,o);let s=o;return o&&o.data&&"object"==typeof o.data&&(console.log("Found data wrapper in pricing response"),s=o.data),s&&await ne.saveCardPricing(e,s),s}catch(t){throw console.error(`Error fetching pricing for card ${e}:`,t),t}},async loadMockData(e,t){try{const n=await fetch("./mock/pricing-response.json"),r=await n.json();return r.name=t||"Charizard",r.set_name=e||"Base Set",r}catch(n){return console.error("Error loading mock data:",n),{id:"mock-id",name:t||"Charizard",set_name:e||"Base Set",num:"4/102",rarity:"Rare Holo",pricing:{market:{value:299.99,currency:"USD"},tcgplayer:{value:305.42,currency:"USD"}}}}}};function ae(e,t,n){const r=e.slice();return r[26]=t[n],r[28]=n,r}function ce(e){let t;function n(e,t){return 0===e[4].length?ie:le}let r=n(e),o=r(e);return{c(){t=g("div"),o.c(),$(t,"class","dropdown svelte-1o6pv8x")},m(n,r){d(n,t,r),o.m(t,null),e[20](t)},p(e,s){r===(r=n(e))&&o?o.p(e,s):(o.d(1),o=r(e),o&&(o.c(),o.m(t,null)))},d(n){n&&u(t),o.d(),e[20](null)}}}function le(e){let t,n=e[4],r=[];for(let t=0;t<n.length;t+=1)r[t]=ue(ae(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=p()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);d(e,t,n)},p(e,o){if(2198&o){let s;for(n=e[4],s=0;s<n.length;s+=1){const a=ae(e,n,s);r[s]?r[s].p(a,o):(r[s]=ue(a),r[s].c(),r[s].m(t.parentNode,t))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(e){f(r,e),e&&u(t)}}}function ie(t){let n;return{c(){n=g("div"),n.textContent="No results found",$(n,"class","no-results svelte-1o6pv8x")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function de(e){let t,n,r,o,s=e[26][e[2]]+"";return{c(){t=g("span"),n=h("("),r=h(s),o=h(")"),$(t,"class","secondary svelte-1o6pv8x")},m(e,s){d(e,t,s),i(t,n),i(t,r),i(t,o)},p(e,t){20&t&&s!==(s=e[26][e[2]]+"")&&y(r,s)},d(e){e&&u(t)}}}function ue(e){let t,n,o,s,a,c,l,f,p=e[26][e[1]]+"",w=e[2]&&e[26][e[2]]&&de(e);function b(){return e[18](e[26])}function x(){return e[19](e[28])}return{c(){t=g("div"),n=g("span"),o=h(p),s=m(),w&&w.c(),a=m(),$(n,"class","label svelte-1o6pv8x"),$(t,"class",c="item item-"+e[28]+" "+(e[7]===e[28]?"highlighted":"")+" svelte-1o6pv8x")},m(e,r){d(e,t,r),i(t,n),i(n,o),i(n,s),w&&w.m(n,null),i(t,a),l||(f=[v(t,"click",b),v(t,"mouseover",x)],l=!0)},p(r,s){e=r,18&s&&p!==(p=e[26][e[1]]+"")&&y(o,p),e[2]&&e[26][e[2]]?w?w.p(e,s):(w=de(e),w.c(),w.m(n,null)):w&&(w.d(1),w=null),128&s&&c!==(c="item item-"+e[28]+" "+(e[7]===e[28]?"highlighted":"")+" svelte-1o6pv8x")&&$(t,"class",c)},d(e){e&&u(t),w&&w.d(),l=!1,r(f)}}}function fe(t){let n,o,s,a,c,l,f,p,b,x=t[6]?"▲":"▼",k=t[6]&&ce(t);return{c(){n=g("div"),o=g("div"),s=g("input"),a=m(),c=g("span"),l=h(x),f=m(),k&&k.c(),$(s,"type","text"),$(s,"placeholder",t[0]),$(s,"autocomplete","off"),$(s,"class","svelte-1o6pv8x"),$(c,"class","dropdown-icon svelte-1o6pv8x"),$(o,"class","input-wrapper svelte-1o6pv8x"),$(n,"class","searchable-select svelte-1o6pv8x")},m(e,r){d(e,n,r),i(n,o),i(o,s),t[16](s),w(s,t[3]),i(o,a),i(o,c),i(c,l),i(n,f),k&&k.m(n,null),p||(b=[v(s,"input",t[17]),v(s,"input",t[12]),v(s,"focus",t[9]),v(s,"keydown",t[10])],p=!0)},p(e,[t]){1&t&&$(s,"placeholder",e[0]),8&t&&s.value!==e[3]&&w(s,e[3]),64&t&&x!==(x=e[6]?"▲":"▼")&&y(l,x),e[6]?k?k.p(e,t):(k=ce(e),k.c(),k.m(n,null)):k&&(k.d(1),k=null)},i:e,o:e,d(e){e&&u(n),t[16](null),k&&k.d(),p=!1,r(b)}}}function ge(e,t,n){let r,o,{items:s=[]}=t,{placeholder:a="Search..."}=t,{labelField:c="name"}=t,{secondaryField:l=null}=t,{value:i=null}=t,d="",u=!1,f=[],g=-1;const h=S();function m(){n(6,u=!1)}function p(){if(g>=0&&o){const e=o.querySelector(`.item-${g}`);e&&e.scrollIntoView({block:"nearest"})}}function v(e){e&&(n(13,i=e),n(3,d=$(e)),m(),h("select",e))}function $(e){return e?l&&e[l]?`${e[c]} (${e[l]})`:e[c]:""}function y(e){u&&r&&!o.contains(e.target)&&!r.contains(e.target)&&m()}k((()=>(document.addEventListener("click",y),()=>{document.removeEventListener("click",y)})));return e.$$set=e=>{"items"in e&&n(14,s=e.items),"placeholder"in e&&n(0,a=e.placeholder),"labelField"in e&&n(1,c=e.labelField),"secondaryField"in e&&n(2,l=e.secondaryField),"value"in e&&n(13,i=e.value)},e.$$.update=()=>{if(8224&e.$$.dirty&&i&&(r&&r.matches(":focus")||n(3,d=$(i))),24606&e.$$.dirty){if(console.log("Filtering items with searchText:",d),s&&Array.isArray(s)){if(!d||""===d.trim()||i&&d===$(i))n(4,f=[...s]);else{const e=d.toLowerCase();n(4,f=s.filter((t=>{if(!t||!t[c])return!1;const n=t[c].toLowerCase().includes(e),r=l&&t[l]&&t[l].toLowerCase().includes(e);return n||r})))}console.log(`Filtered to ${f.length} items`)}else n(4,f=[]);n(7,g=-1)}},[a,c,l,d,f,r,u,g,o,function(){console.log("Input focused"),n(6,u=!0)},function(e){switch(e.key){case"ArrowDown":e.preventDefault(),u||n(6,u=!0),n(7,g=Math.min(g+1,f.length-1)),p();break;case"ArrowUp":e.preventDefault(),u||n(6,u=!0),n(7,g=Math.max(g-1,-1)),p();break;case"Enter":u&&g>=0&&g<f.length&&v(f[g]);break;case"Escape":m()}},v,function(){n(6,u=!0),i&&d!==$(i)&&(console.log("Text changed, clearing selection"),n(13,i=null),h("select",null))},i,s,function(){console.log("Clearing selection programmatically"),n(13,i=null),n(3,d=""),n(6,u=!0),n(4,f=[...s]),h("select",null),r&&r.focus()},function(e){A[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},function(){d=this.value,n(3,d),n(13,i),n(5,r)},e=>v(e),e=>n(7,g=e),function(e){A[e?"unshift":"push"]((()=>{o=e,n(8,o)}))}]}class he extends Y{constructor(e){super(),G(this,e,ge,fe,s,{items:14,placeholder:0,labelField:1,secondaryField:2,value:13,clearSelection:15})}get clearSelection(){return this.$$.ctx[15]}}function me(e,t,n){const r=e.slice();return r[24]=t[n],r[26]=n,r}function pe(e){let t;function n(e,t){return 0===e[2].length?$e:ve}let r=n(e),o=r(e);return{c(){t=g("div"),o.c(),$(t,"class","dropdown svelte-ii44bh")},m(n,r){d(n,t,r),o.m(t,null),e[19](t)},p(e,s){r===(r=n(e))&&o?o.p(e,s):(o.d(1),o=r(e),o&&(o.c(),o.m(t,null)))},d(n){n&&u(t),o.d(),e[19](null)}}}function ve(e){let t,n=e[2],r=[];for(let t=0;t<n.length;t+=1)r[t]=we(me(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=p()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);d(e,t,n)},p(e,o){if(548&o){let s;for(n=e[2],s=0;s<n.length;s+=1){const a=me(e,n,s);r[s]?r[s].p(a,o):(r[s]=we(a),r[s].c(),r[s].m(t.parentNode,t))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(e){f(r,e),e&&u(t)}}}function $e(t){let n;return{c(){n=g("div"),n.textContent="No matching cards found",$(n,"class","no-results svelte-ii44bh")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function ye(e){let t,n,r,o,s=e[24].num+"";return{c(){t=g("span"),n=h("("),r=h(s),o=h(")"),$(t,"class","card-num svelte-ii44bh")},m(e,s){d(e,t,s),i(t,n),i(t,r),i(t,o)},p(e,t){4&t&&s!==(s=e[24].num+"")&&y(r,s)},d(e){e&&u(t)}}}function we(e){let t,n,o,s,a,c,l,f,p,w=e[24].name+"",b=e[24].num&&ye(e);function x(){return e[17](e[24])}function k(){return e[18](e[26])}return{c(){t=g("div"),n=g("div"),o=g("span"),s=h(w),a=m(),b&&b.c(),c=m(),$(o,"class","card-name svelte-ii44bh"),$(n,"class","card-info svelte-ii44bh"),$(t,"class",l="card-item card-item-"+e[26]+" "+(e[5]===e[26]?"highlighted":"")+" svelte-ii44bh")},m(e,r){d(e,t,r),i(t,n),i(n,o),i(o,s),i(o,a),b&&b.m(o,null),i(t,c),f||(p=[v(t,"click",x),v(t,"mouseover",k)],f=!0)},p(n,r){e=n,4&r&&w!==(w=e[24].name+"")&&y(s,w),e[24].num?b?b.p(e,r):(b=ye(e),b.c(),b.m(o,null)):b&&(b.d(1),b=null),32&r&&l!==(l="card-item card-item-"+e[26]+" "+(e[5]===e[26]?"highlighted":"")+" svelte-ii44bh")&&$(t,"class",l)},d(e){e&&u(t),b&&b.d(),f=!1,r(p)}}}function be(t){let n,o,s,a,c,l,f,p,b,x=t[4]?"▲":"▼",k=t[4]&&pe(t);return{c(){n=g("div"),o=g("div"),s=g("input"),a=m(),c=g("span"),l=h(x),f=m(),k&&k.c(),$(s,"type","text"),$(s,"placeholder",t[0]),$(s,"autocomplete","off"),$(s,"class","svelte-ii44bh"),$(c,"class","icon svelte-ii44bh"),$(o,"class","input-wrapper svelte-ii44bh"),$(n,"class","card-search svelte-ii44bh")},m(e,r){d(e,n,r),i(n,o),i(o,s),t[15](s),w(s,t[1]),i(o,a),i(o,c),i(c,l),i(n,f),k&&k.m(n,null),p||(b=[v(s,"input",t[16]),v(s,"input",t[7]),v(s,"focus",t[8]),v(s,"keydown",t[10])],p=!0)},p(e,[t]){1&t&&$(s,"placeholder",e[0]),2&t&&s.value!==e[1]&&w(s,e[1]),16&t&&x!==(x=e[4]?"▲":"▼")&&y(l,x),e[4]?k?k.p(e,t):(k=pe(e),k.c(),k.m(n,null)):k&&(k.d(1),k=null)},i:e,o:e,d(e){e&&u(n),t[15](null),k&&k.d(),p=!1,r(b)}}}function xe(e){return e?e.num?`${e.name} (${e.num})`:e.name:""}function ke(e,t,n){let r,o,{cards:s=[]}=t,{placeholder:a="Search for a card..."}=t,{selectedCard:c=null}=t,l="",i=!1,d=[],u=-1;const f=S();function g(e){console.log("Card selected:",e?.name),e&&(n(11,c=e),n(1,l=xe(e)),h(),f("select",e))}function h(){n(4,i=!1)}function m(){if(u>=0&&o){const e=o.querySelector(`.card-item-${u}`);e&&e.scrollIntoView({block:"nearest"})}}function p(){console.log("Clearing card selection"),n(11,c=null),n(1,l=""),f("select",null),n(4,i=!1),r&&r.focus()}function v(e){i&&r&&!o.contains(e.target)&&!r.contains(e.target)&&h()}k((()=>(document.addEventListener("click",v),()=>{document.removeEventListener("click",v)})));return e.$$set=e=>{"cards"in e&&n(12,s=e.cards),"placeholder"in e&&n(0,a=e.placeholder),"selectedCard"in e&&n(11,c=e.selectedCard)},e.$$.update=()=>{if(2056&e.$$.dirty&&c&&c.name&&r&&!r.matches(":focus")&&n(1,l=xe(c)),4110&e.$$.dirty){if(console.log(`Filtering ${s.length} cards with search: "${l}"`),l&&""!==l.trim()){const e=l.toLowerCase().trim();n(2,d=s.filter((t=>{if(!t||!t.name)return!1;const n=t.name.toLowerCase().includes(e),r=t.num&&t.num.toLowerCase().includes(e);return n||r}))),r&&r.matches(":focus")&&n(4,i=!0)}else n(2,d=[...s].slice(0,100));n(5,u=-1),console.log(`Filtered to ${d.length} cards`)}},[a,l,d,r,i,u,o,function(){console.log("Input changed:",l),n(4,i=!0),c&&l!==xe(c)&&(console.log("Text doesn't match selected card, clearing selection"),n(11,c=null),f("select",null))},function(){console.log("Input focused"),n(4,i=!0)},g,function(e){if(i)switch(e.key){case"ArrowDown":e.preventDefault(),n(5,u=Math.min(u+1,d.length-1)),m();break;case"ArrowUp":e.preventDefault(),n(5,u=Math.max(u-1,-1)),m();break;case"Enter":u>=0&&u<d.length&&g(d[u]);break;case"Escape":h();break;case"Backspace":l.length<=1&&setTimeout((()=>{n(4,i=!0)}),0)}},c,s,p,function(){p(),r&&(r.focus(),setTimeout((()=>{n(4,i=!0),n(1,l=""),n(2,d=[...s].slice(0,100))}),10))},function(e){A[e?"unshift":"push"]((()=>{r=e,n(3,r)}))},function(){l=this.value,n(1,l),n(11,c),n(3,r)},e=>g(e),e=>n(5,u=e),function(e){A[e?"unshift":"push"]((()=>{o=e,n(6,o)}))}]}class Se extends Y{constructor(e){super(),G(this,e,ke,be,s,{cards:12,placeholder:0,selectedCard:11,clearSelection:13,clearAndFocus:14})}get clearSelection(){return this.$$.ctx[13]}get clearAndFocus(){return this.$$.ctx[14]}}function Ce(e,t,n){const r=e.slice();return r[10]=t[n],r}function Pe(e){let t,n,o,s,a,c,l,p,w,b,x,k,S,C,P,A,I,j,E,_,F,U,D,L=e[0][0]?.name+"",N=e[0],T=[];for(let t=0;t<N.length;t+=1)T[t]=Ee(Ce(e,N,t));return{c(){t=g("div"),n=g("div"),o=g("div"),s=g("h3"),s.textContent="Multiple Variants Found",a=m(),c=g("button"),c.textContent="×",l=m(),p=g("div"),w=g("p"),b=h('Multiple versions of "'),x=h(L),k=h('" were found in this set. Please select the specific variant:'),S=m(),C=g("div");for(let e=0;e<T.length;e+=1)T[e].c();P=m(),A=g("div"),I=g("button"),j=h("Select Variant"),_=m(),F=g("button"),F.textContent="Cancel",$(s,"class","svelte-1j7g73e"),$(c,"class","close-button svelte-1j7g73e"),$(o,"class","modal-header svelte-1j7g73e"),$(C,"class","variants-list svelte-1j7g73e"),$(p,"class","modal-body svelte-1j7g73e"),$(I,"class","confirm-button svelte-1j7g73e"),I.disabled=E=!e[2],$(F,"class","cancel-button svelte-1j7g73e"),$(A,"class","modal-footer svelte-1j7g73e"),$(n,"class","modal svelte-1j7g73e"),$(t,"class","overlay svelte-1j7g73e")},m(r,u){d(r,t,u),i(t,n),i(n,o),i(o,s),i(o,a),i(o,c),i(n,l),i(n,p),i(p,w),i(w,b),i(w,x),i(w,k),i(p,S),i(p,C);for(let e=0;e<T.length;e+=1)T[e].m(C,null);var f;i(n,P),i(n,A),i(A,I),i(I,j),i(A,_),i(A,F),U||(D=[v(c,"click",e[5]),v(I,"click",e[9]),v(F,"click",e[5]),v(n,"click",(f=e[7],function(e){return e.stopPropagation(),f.call(this,e)})),v(t,"click",e[5])],U=!0)},p(e,t){if(1&t&&L!==(L=e[0][0]?.name+"")&&y(x,L),81&t){let n;for(N=e[0],n=0;n<N.length;n+=1){const r=Ce(e,N,n);T[n]?T[n].p(r,t):(T[n]=Ee(r),T[n].c(),T[n].m(C,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=N.length}4&t&&E!==(E=!e[2])&&(I.disabled=E)},d(e){e&&u(t),f(T,e),U=!1,r(D)}}}function Ae(e){let t,n,r=e[10].rarity+"";return{c(){t=g("span"),n=h(r),$(t,"class","variant-rarity svelte-1j7g73e")},m(e,r){d(e,t,r),i(t,n)},p(e,t){1&t&&r!==(r=e[10].rarity+"")&&y(n,r)},d(e){e&&u(t)}}}function Ie(e){let t,n,r=e[10].variant+"";return{c(){t=g("span"),n=h(r),$(t,"class","variant-type svelte-1j7g73e")},m(e,r){d(e,t,r),i(t,n)},p(e,t){1&t&&r!==(r=e[10].variant+"")&&y(n,r)},d(e){e&&u(t)}}}function je(e){let t,n,r,o;return{c(){t=g("div"),n=g("img"),n.src!==(r=e[10].image_url)&&$(n,"src",r),$(n,"alt",o=e[10].name),$(n,"class","svelte-1j7g73e"),$(t,"class","variant-thumbnail svelte-1j7g73e")},m(e,r){d(e,t,r),i(t,n)},p(e,t){1&t&&n.src!==(r=e[10].image_url)&&$(n,"src",r),1&t&&o!==(o=e[10].name)&&$(n,"alt",o)},d(e){e&&u(t)}}}function Ee(e){let t,n,r,o,s,a,c,l,f,p,w,b,x,k,S,C,P=e[10].name+"",A=e[10].num+"",I=e[10].rarity&&Ae(e),j=e[10].variant&&Ie(e),E=e[10].image_url&&je(e);function _(){return e[8](e[10])}return{c(){t=g("div"),n=g("div"),r=g("div"),o=h(P),s=m(),a=g("div"),c=g("span"),l=h("#"),f=h(A),p=m(),I&&I.c(),w=m(),j&&j.c(),b=m(),E&&E.c(),x=m(),$(r,"class","variant-name svelte-1j7g73e"),$(c,"class","variant-number svelte-1j7g73e"),$(a,"class","variant-info svelte-1j7g73e"),$(n,"class","variant-details svelte-1j7g73e"),$(t,"class",k="variant-item "+(e[6](e[10])?"selected":"")+" svelte-1j7g73e")},m(e,u){d(e,t,u),i(t,n),i(n,r),i(r,o),i(n,s),i(n,a),i(a,c),i(c,l),i(c,f),i(a,p),I&&I.m(a,null),i(a,w),j&&j.m(a,null),i(n,b),E&&E.m(n,null),i(t,x),S||(C=v(t,"click",_),S=!0)},p(r,s){e=r,1&s&&P!==(P=e[10].name+"")&&y(o,P),1&s&&A!==(A=e[10].num+"")&&y(f,A),e[10].rarity?I?I.p(e,s):(I=Ae(e),I.c(),I.m(a,w)):I&&(I.d(1),I=null),e[10].variant?j?j.p(e,s):(j=Ie(e),j.c(),j.m(a,null)):j&&(j.d(1),j=null),e[10].image_url?E?E.p(e,s):(E=je(e),E.c(),E.m(n,null)):E&&(E.d(1),E=null),1&s&&k!==(k="variant-item "+(e[6](e[10])?"selected":"")+" svelte-1j7g73e")&&$(t,"class",k)},d(e){e&&u(t),I&&I.d(),j&&j.d(),E&&E.d(),S=!1,C()}}}function _e(t){let n,r=t[1]&&t[0].length>0&&Pe(t);return{c(){r&&r.c(),n=p()},m(e,t){r&&r.m(e,t),d(e,n,t)},p(e,[t]){e[1]&&e[0].length>0?r?r.p(e,t):(r=Pe(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:e,o:e,d(e){r&&r.d(e),e&&u(n)}}}function Fe(e,t,n){let{variants:r=[]}=t,{isVisible:o=!1}=t,s=null;const a=S();function c(e){n(2,s=e),a("select",e)}function l(){a("close")}return e.$$set=e=>{"variants"in e&&n(0,r=e.variants),"isVisible"in e&&n(1,o=e.isVisible)},e.$$.update=()=>{1&e.$$.dirty&&r&&r.length&&n(2,s=null)},[r,o,s,a,c,l,function(e){return s&&s.id===e.id},function(t){C.call(this,e,t)},e=>c(e),()=>{s&&(a("confirm",s),l())}]}class Ue extends Y{constructor(e){super(),G(this,e,Fe,_e,s,{variants:0,isVisible:1})}}function De(e,t,n){const r=e.slice();return r[25]=t[n][0],r[26]=t[n][1],r}function Le(e){let t,n,r;function o(t){e[19](t)}let s={cards:e[6]};return void 0!==e[8]&&(s.selectedCard=e[8]),t=new Se({props:s}),e[18](t),A.push((()=>H(t,"selectedCard",o))),t.$on("select",e[12]),{c(){V(t.$$.fragment)},m(e,n){J(t,e,n),r=!0},p(e,r){const o={};64&r&&(o.cards=e[6]),!n&&256&r&&(n=!0,o.selectedCard=e[8],U((()=>n=!1))),t.$set(o)},i(e){r||(z(t.$$.fragment,e),r=!0)},o(e){O(t.$$.fragment,e),r=!1},d(n){e[18](null),Z(t,n)}}}function Ne(t){let n;return{c(){n=g("div"),n.innerHTML='<input disabled="" placeholder="No cards found for this set" class="svelte-18i9rx1"/>',$(n,"class","error-select svelte-18i9rx1")},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function Te(t){let n;return{c(){n=g("div"),n.innerHTML='<input disabled="" placeholder="Loading cards..." class="svelte-18i9rx1"/>',$(n,"class","loading-select svelte-18i9rx1")},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function Me(t){let n;return{c(){n=g("div"),n.innerHTML='<input disabled="" placeholder="Select a set first" class="svelte-18i9rx1"/>',$(n,"class","disabled-select svelte-18i9rx1")},m(e,t){d(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function Re(e){let t,n;return{c(){t=g("p"),n=h(e[4]),$(t,"class","error svelte-18i9rx1")},m(e,r){d(e,t,r),i(t,n)},p(e,t){16&t&&y(n,e[4])},d(e){e&&u(t)}}}function ze(e){let t,n,r,o,s,a,c,l,f,p,v,w,b,x,k,S,C,P,A=(e[2]?.name||e[8]&&e[8].name||"Card")+"",I=(e[2]?.set_name||e[1]&&e[1].name||"Unknown")+"",j=(e[2]?.num||e[8]&&e[8].num||"Unknown")+"",E=(e[2]&&e[2].rarity||e[8]&&e[8].rarity)&&Oe(e);function _(e,t){return(null==P||4&t)&&(P=!(e[2]?.pricing&&0!==Object.keys(e[2].pricing||{}).length)),P?Ve:He}let F=_(e,-1),U=F(e);return{c(){t=g("div"),n=g("h2"),r=h(A),o=m(),s=g("p"),a=g("strong"),a.textContent="Set:",c=m(),l=h(I),f=m(),p=g("p"),v=g("strong"),v.textContent="Number:",w=m(),b=h(j),x=m(),E&&E.c(),k=m(),S=g("h3"),S.textContent="Prices:",C=m(),U.c(),$(n,"class","svelte-18i9rx1"),$(S,"class","svelte-18i9rx1"),$(t,"class","results svelte-18i9rx1")},m(e,u){d(e,t,u),i(t,n),i(n,r),i(t,o),i(t,s),i(s,a),i(s,c),i(s,l),i(t,f),i(t,p),i(p,v),i(p,w),i(p,b),i(t,x),E&&E.m(t,null),i(t,k),i(t,S),i(t,C),U.m(t,null)},p(e,n){260&n&&A!==(A=(e[2]?.name||e[8]&&e[8].name||"Card")+"")&&y(r,A),6&n&&I!==(I=(e[2]?.set_name||e[1]&&e[1].name||"Unknown")+"")&&y(l,I),260&n&&j!==(j=(e[2]?.num||e[8]&&e[8].num||"Unknown")+"")&&y(b,j),e[2]&&e[2].rarity||e[8]&&e[8].rarity?E?E.p(e,n):(E=Oe(e),E.c(),E.m(t,k)):E&&(E.d(1),E=null),F===(F=_(e,n))&&U?U.p(e,n):(U.d(1),U=F(e),U&&(U.c(),U.m(t,null)))},d(e){e&&u(t),E&&E.d(),U.d()}}}function Oe(e){let t,n,r,o,s=(e[2]&&e[2].rarity||e[8]&&e[8].rarity||"Unknown")+"";return{c(){t=g("p"),n=g("strong"),n.textContent="Rarity:",r=m(),o=h(s)},m(e,s){d(e,t,s),i(t,n),i(t,r),i(t,o)},p(e,t){260&t&&s!==(s=(e[2]&&e[2].rarity||e[8]&&e[8].rarity||"Unknown")+"")&&y(o,s)},d(e){e&&u(t)}}}function He(e){let t,n=Object.entries(e[2].pricing||{}),r=[];for(let t=0;t<n.length;t+=1)r[t]=Je(De(e,n,t));return{c(){t=g("ul");for(let e=0;e<r.length;e+=1)r[e].c();$(t,"class","svelte-18i9rx1")},m(e,n){d(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,o){if(4&o){let s;for(n=Object.entries(e[2].pricing||{}),s=0;s<n.length;s+=1){const a=De(e,n,s);r[s]?r[s].p(a,o):(r[s]=Je(a),r[s].c(),r[s].m(t,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(e){e&&u(t),f(r,e)}}}function Ve(t){let n;return{c(){n=g("p"),n.textContent="No pricing data available for this card.",$(n,"class","no-prices svelte-18i9rx1")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function Je(e){let t,n,r,o,s,a,c,l,f,p,v,w,b=e[25]+"",x=Be(e[26]?.value)+"",k=(e[26]?.currency||"USD")+"";return{c(){t=g("li"),n=g("span"),r=h(b),o=h(":"),s=m(),a=g("span"),c=h("$"),l=h(x),f=m(),p=g("span"),v=h(k),w=m(),$(n,"class","market svelte-18i9rx1"),$(a,"class","price svelte-18i9rx1"),$(p,"class","currency svelte-18i9rx1"),$(t,"class","svelte-18i9rx1")},m(e,u){d(e,t,u),i(t,n),i(n,r),i(n,o),i(t,s),i(t,a),i(a,c),i(a,l),i(t,f),i(t,p),i(p,v),i(t,w)},p(e,t){4&t&&b!==(b=e[25]+"")&&y(r,b),4&t&&x!==(x=Be(e[26]?.value)+"")&&y(l,x),4&t&&k!==(k=(e[26]?.currency||"USD")+"")&&y(v,k)},d(e){e&&u(t)}}}function Ze(e){let t,n,o,s,a,c,l,f,p,w,b,x,k,S,C,P,I,j,E,_,F,D,L,N,T,M,B=e[3]?"Loading...":"Get Price";function G(t){e[17](t)}let Y={items:e[5],labelField:"name",secondaryField:"code",placeholder:"Search for a set..."};void 0!==e[1]&&(Y.value=e[1]),f=new he({props:Y}),A.push((()=>H(f,"value",G))),f.$on("select",e[11]);const q=[Me,Te,Ne,Le],W=[];function K(e,t){return e[1]?e[7]?1:0===e[6].length?2:3:0}S=K(e),C=W[S]=q[S](e);let Q=e[4]&&Re(e),X=null!==e[2]&&void 0!==e[2]&&"object"==typeof e[2]&&ze(e);return L=new Ue({props:{variants:e[10],isVisible:e[9]}}),L.$on("select",e[13]),L.$on("confirm",e[14]),L.$on("close",e[15]),{c(){t=g("main"),n=g("header"),n.innerHTML='<h1 class="svelte-18i9rx1">Pokémon Card Price Checker</h1>',o=m(),s=g("div"),a=g("div"),c=g("label"),c.textContent="Select Set:",l=m(),V(f.$$.fragment),w=m(),b=g("div"),x=g("label"),x.textContent="Card Name:",k=m(),C.c(),P=m(),I=g("button"),j=h(B),_=m(),Q&&Q.c(),F=m(),X&&X.c(),D=m(),V(L.$$.fragment),$(n,"class","svelte-18i9rx1"),$(c,"for","setSelect"),$(c,"class","svelte-18i9rx1"),$(a,"class","form-group svelte-18i9rx1"),$(x,"for","cardName"),$(x,"class","svelte-18i9rx1"),$(b,"class","form-group svelte-18i9rx1"),I.disabled=E=e[3]||!e[8],$(I,"class","svelte-18i9rx1"),$(s,"class","form-container svelte-18i9rx1"),$(t,"class","svelte-18i9rx1")},m(r,u){d(r,t,u),i(t,n),i(t,o),i(t,s),i(s,a),i(a,c),i(a,l),J(f,a,null),i(s,w),i(s,b),i(b,x),i(b,k),W[S].m(b,null),i(s,P),i(s,I),i(I,j),i(s,_),Q&&Q.m(s,null),i(s,F),X&&X.m(s,null),i(t,D),J(L,t,null),N=!0,T||(M=v(I,"click",e[16]),T=!0)},p(e,[t]){const n={};32&t&&(n.items=e[5]),!p&&2&t&&(p=!0,n.value=e[1],U((()=>p=!1))),f.$set(n);let o=S;S=K(e),S===o?W[S].p(e,t):(R={r:0,c:[],p:R},O(W[o],1,1,(()=>{W[o]=null})),R.r||r(R.c),R=R.p,C=W[S],C?C.p(e,t):(C=W[S]=q[S](e),C.c()),z(C,1),C.m(b,null)),(!N||8&t)&&B!==(B=e[3]?"Loading...":"Get Price")&&y(j,B),(!N||264&t&&E!==(E=e[3]||!e[8]))&&(I.disabled=E),e[4]?Q?Q.p(e,t):(Q=Re(e),Q.c(),Q.m(s,F)):Q&&(Q.d(1),Q=null),null!==e[2]&&void 0!==e[2]&&"object"==typeof e[2]?X?X.p(e,t):(X=ze(e),X.c(),X.m(s,null)):X&&(X.d(1),X=null);const a={};512&t&&(a.isVisible=e[9]),L.$set(a)},i(e){N||(z(f.$$.fragment,e),z(C),z(L.$$.fragment,e),N=!0)},o(e){O(f.$$.fragment,e),O(C),O(L.$$.fragment,e),N=!1},d(e){e&&u(t),Z(f),W[S].d(),Q&&Q.d(),X&&X.d(),Z(L),T=!1,M()}}}function Be(e){return null==e?"0.00":parseFloat(e).toFixed(2)}function Ge(e){if(!e||"object"!=typeof e)return{};const t={};try{Object.entries(e).forEach((([e,n])=>{null!=n&&("object"==typeof n&&void 0!==n.value&&null!==n.value&&parseFloat(n.value)>0?t[e]=n:"number"==typeof n&&n>0?t[e]={value:n,currency:"USD"}:"string"==typeof n&&parseFloat(n)>0&&(t[e]={value:parseFloat(n),currency:"USD"}))}))}catch(e){return console.error("Error filtering prices:",e),{}}return t}function Ye(e,t,n){let r,o=null,s="",a=null,c=!1,l=null,i=[],d=[],u=!1,f=null,g=!1,h=null;return k((async()=>{try{console.log("Initializing app and loading set list...");const e=await se.getSetList();console.log(`Loaded ${e.length} sets`);const t=e.filter((e=>!e.id));if(t.length>0){console.warn(`Found ${t.length} sets without IDs`);let n=Math.max(...e.filter((e=>e.id)).map((e=>e.id)),0);t.forEach((e=>{n++,e.id=n})),console.log("Added IDs to sets that were missing them")}const r=e.filter((e=>!e.code));r.length>0&&console.warn(`Found ${r.length} sets without codes`),n(5,i=e)}catch(e){console.error("Error loading set list:",e),console.log("Using fallback set list");const{setList:t}=await import("./setList-d592518d.js");n(5,i=t)}console.log(`Available sets: ${i.length}`),i.length>0&&console.log("First few sets:",i.slice(0,3))})),[r,o,a,c,l,i,d,u,f,g,[],async function(e){n(1,o=e.detail),console.log("Selected set:",o),o&&o.id?async function(e){if(!e)return;if(!e.id)return console.error("Set ID is required but not available:",e),void n(4,l="Selected set is missing required data.");try{n(2,a=null),n(8,f=null),s="",n(6,d=[]),n(7,u=!0),n(4,l=null),console.log(`Loading cards for set ${e.name} (code: ${e.code}, id: ${e.id})...`);let t=await se.getCardsForSet(e.code,e.id);if(t&&0!==t.length||(console.log(`No cards returned from API for set ${e.code}, trying fallback data`),"PRE"===e.code?(console.log("Using fallback data for Prismatic Evolutions"),t=prismaticEvolutionsCards):(console.log(`Generating dummy cards for set ${e.code}`),t=Array.from({length:20},((t,n)=>({id:`dummy-${e.code}-${n+1}`,name:`${e.name} Card ${n+1}`,num:`${n+1}/100`,set_code:e.code,set_name:e.name}))))),console.log(`Received ${t?t.length:0} cards from API/cache`),!t||0===t.length)return console.log("No cards returned for this set"),void n(7,u=!1);const r=t[0];console.log("Sample card structure:",r),console.log(`Received ${t.length} cards for set ${e.name}`),n(6,d=t.map((e=>({id:e.id||`fallback-${e.num||Math.random()}`,name:e.name||"Unknown Card",num:e.num||"",rarity:e.rarity||"",variant:e.variant||"",image_url:e.image_url||""})))),console.log(`Transformed ${d.length} cards for display`);const o=t.filter((e=>!e.name));o.length>0&&(console.warn(`Found ${o.length} cards without names!`),console.warn("Sample invalid card:",o[0])),n(7,u=!1),n(7,u=!1)}catch(e){console.error("Error loading cards for set:",e),n(7,u=!1),n(6,d=[])}}(o):(console.error("Selected set does not have an ID property:",o),n(4,l="Invalid set data. Please select a different set."))},function(e){console.log("Card selection event:",e.detail),n(2,a=null),n(8,f=e.detail),s=f?f.name:"",n(4,l=null),f&&!f.id&&(console.error("Selected card does not have an ID property:",f),n(4,l="Invalid card data. Please select a different card."))},function(e){h=e.detail},function(e){h=e.detail,async function(e){try{if(!e||!e.id)throw new Error("Invalid card variant");n(3,c=!0),n(4,l=null);const t=await se.getCardPricing(e.id);t&&t.pricing&&(t.pricing=Ge(t.pricing)),n(2,a=t),n(3,c=!1)}catch(t){console.error("Error loading pricing for variant:",t),n(4,l=t.message),n(3,c=!1);try{console.log("Attempting to load mock data for variant...");const t=await se.loadMockData(o.name,s);t&&t.pricing&&(t.pricing=Ge(t.pricing)),e&&(t.name=e.name,t.num=e.num,e.rarity&&(t.rarity=e.rarity)),n(2,a=t),n(4,l="Using mock data (API unavailable). This is for demonstration purposes only.")}catch(e){console.error("Failed to load mock data:",e)}}}(h)},function(){n(9,g=!1)},async function(){if(o)if(f){n(3,c=!0),n(4,l=null);try{const e=f?f.id:null;if(!e)throw new Error("Invalid card selection - missing ID");console.log(`Fetching price data for card ID: ${e}`);const t=await se.getCardPricing(e);console.log("Received price data:",t),t&&t.pricing?(t.pricing=Ge(t.pricing),console.log("Filtered pricing data:",t.pricing)):console.warn("No pricing data found in the response:",t),n(2,a=t)}catch(e){console.error("API Error:",e),n(4,l=e.message);try{console.log("Attempting to load mock data...");const e=await se.loadMockData(o.name,s);e&&e.pricing&&(e.pricing=Ge(e.pricing)),n(2,a=e),n(4,l="Using mock data (API unavailable). This is for demonstration purposes only.")}catch(e){console.error("Failed to load mock data:",e)}}finally{n(3,c=!1)}}else n(4,l="Please select a card");else n(4,l="Please select a set")},function(e){o=e,n(1,o)},function(e){A[e?"unshift":"push"]((()=>{r=e,n(0,r)}))},function(e){f=e,n(8,f)}]}const qe=new class extends Y{constructor(e){super(),G(this,e,Ye,Ze,s,{})}}({target:document.body});export default qe;
//# sourceMappingURL=main.js.map
